---
layout: post
title: Legendre's three-square theorem
tags: Number-Theory
date: 2020-08-18 04:00:00
updated: 2021-06-24 23:59:58
---

# 르장드르 세 제곱수 정리

라그랑주 네 제곱수 정리와 페르마 두 제곱수 정리는 덧셈적 정수론의 문제로, 정수의 제곱수의 합으로 어떤 정수들을 표현할 수 있는지 기술한다. 라그랑주 네 제곱수 정리는 모든 양의 정수는 정수의 제곱수 네 개의 합으로 나타날 수 있다는 정리이고, 페르마 두 제곱수 정리는 어떤 소수 $p$가 정수의 제곱수 두 개의 합으로 나타난다는 것과 $p = 2$ 또는 $p \equiv 1 \pmod{4}$가 동치라는 명제이다. 이 포스트에서는 정수의 제곱수 세 개의 합으로 나타나는 정수는 어떤 형태인지 확인할 것이다.

르장드르 세 제곱수 정리는, $4^a (8n + 7)$ 꼴이 아닌 양의 정수는 정수의 제곱수 세 개의 합으로 나타난다는 정리이다. 명제의 역은 비교적 자명하다. $4^a (8n + 7)$ 꼴의 정수를 세 개의 제곱수의 합으로 나타낼 수 있어, 정수 $x, y, z$에 대해 $x^2 + y^2 + z^2 = 4^a (8n + 7)$이라고 가정하자. $x, y, z$가 $2^a$로 나누어진다는 사실은 법 4에 대해 방정식을 관찰함으로써 어렵지 않게 보일 수 있고, 정수 $s = x/2^a, t = y/2^a, u = z/2^a$에 대해 $s^2 + t^2 + u^2 \not\equiv 7 \pmod{8}$이므로 모순이다. [1]을 따라 르장드르 세 제곱수 정리를 증명하여 보자. 논문에서는 독자가 이차상호성과, 볼록 집합의 격자점에 관한 민코프스키 정리를 알고 있다고 가정한다. 또한 어떤 수가 제곱수 두 개의 합으로 나타내어지는지에 대해서도 알고 있어야 한다.

양의 정수 $m$이 $4^a (8n + 7)$의 꼴이 아니라고 하자. 제곱수들의 합으로 $m$을 표현하고 싶으므로, $m$은 제곱인수가 없는 수라고 가정해도 무방하다. 우선 $m \equiv 3 \pmod{8}$을 가정하고 문제를 해결하여 볼 것이다. $m$을 소인수분해하여 $m = p_1 p_2 \cdots p_r$와 같이 쓰자. $p_i$는 소수이다.

다음을 만족하는 소수 $q$를 생각할 것이다:
* $i \in \{1, 2, \dots, r\}$에 대해 $(-2q/p_i) = +1$,
* $q \equiv 1 \pmod{4}$.

$(a/b)$는 야코비 기호<sup>Jacobi Symbol</sup>이다. 이러한 소수 $q$는 등차수열에 관한 디리클레 정리에 의해 존재한다. $4m$과 위의 조건을 모두 만족하는 나머지 모임 $r$을 선택하면 둘은 서로소이므로, 수열 $4mt + r, t = 1, 2, \cdots$에는 무한히 많은 소수가 존재한다. 소수들 중 하나를 뽑아 $q$라고 하자.

위의 조건과 $m \equiv 3 \pmod{8}$임을 이용하면 아래 등식들이 성립함을 보일 수 있다. 
$$
\begin{align*}
1 & = \prod_{i = 1}^r (-2q/p_i) = \prod_{i = 1}^r (-2/p_i)(q/p_i) \\
& = (-2/m) \prod_{i = 1}^r (p_i/q) \\
& = (-2/m)(m/q) = (-2/m)(-m/q) \\
& = (-m/q)
\end{align*}
$$
$q \equiv 1 \pmod{4}$이므로 $(-1/q) = 1$이다. $m \equiv 3 \pmod{8}$ 이므로 $(-2/m) = 1$이다. 따라서 $b^2 \equiv -m \pmod{q}$를 만족하는 홀수 $b$를 찾을 수 있다. 즉, 다음 방정식의 해가 존재한다.
$$
b^2 - q h_1 = -m.
$$
이 등식을 법 4에 대해 고려하면 $1 - h_1 \equiv 1 \pmod{4}$이므로 $h_1 = 4h$는 4의 배수이다. 한편, $(-2q/p_i) = 1$ 조건에 의해 $(-2q/m) = 1$이다. 따라서 $t^2 \equiv -1/2q \pmod{m}$을 만족하는 정수 $t$가 존재한다.

잠시 다른 이야기로 넘어가서, 다음과 같은 입체 $K$와 좌표변환을 생각하자.
$$K: R^2 + S^2 + T^2 < 2m$$

$$
\begin{align*}
R & = 2tqx + tby + mz, \\
S & = (2q)^{1/2} x + b/(2q)^{1/2} y, \\
T & = m^{1/2}/(2q)^{1/2} y
\end{align*}
$$

$(R, S, T)$ 좌표 공간에서 입체 $K$는 구이므로 부피는 $4/3(2m)^{3/2}$이다. 이 좌표변환은 단지 괴상한 계수들을 가진 일차변환이고, 이 변환의 판별식은 $m^{3/2}$이다. $t$는 판별식에 영향을 주지 않았으므로 $t$의 선택은 이 단계에서 크게 영향을 주지 않는다. 따라서 $(x, y, z)$ 좌표 공간에서 입체 $K$의 부피는 $1/3 (2^{7/2} \pi)$이다. $K$는 원점 대칭인 볼록 집합이고, 이의 부피는 8보다 크다. 민코프스키 정리의 조건이 완벽하게 들어맞는다.

민코프스키 정리에 의해, $K$는 $(0, 0, 0)$이 아닌 격자점 $(x, y, z)$를 포함한다. $(x_1, y_1, z_1)$를 $K$에 포함되는 정수격자점이라고 하고, $R_1, S_1, T_1$를 각각 좌표변환을 통해 $(x_1, y_1, z_1)$에 대응되는 $R, S, T$ 값이라고 하자. 좌표변환에 사용된 식을 그대로 대입하여 보면:
$$
\begin{align*}
R_1^2 + S_1^2 + T_1^2 & = (2tqx_1 + tby_1 + mz_1)^2 + \left( (2q)^{1/2} x_1 + \frac{b}{(2q)^{1/2}} y_1 \right)^2 + \left( \frac{m^{1/2}}{(2q)^{1/2}}y_1 \right)^2 \\
& \equiv t^2 (2qx_1 + by_1)^2 + \frac{1}{2q} (2qx_1 + by_1)^2 \\
& \equiv 0 \pmod{m}.
\end{align*}
$$
첫 번째 합동은 $m$에 관한 항을 적당히 빼어줌으로써 성립한다. 마지막 합동은 $t$의 선택에 의해 성립한다.

$S_1^2 + T_1^2$가 정수로 나타남을 보이자. 그냥 전개하여 보면 얻을 수 있는 결과이다:
$$
\begin{align*}
S_1^2 + T_1^2 & = \left( (2q)^{1/2} x_1 + \frac{b}{(2q)^{1/2}} y_1 \right)^2 + \left( \frac{m^{1/2}}{(2q)^{1/2}} y_1 \right)^2 \\
& = \frac{1}{2q} (2q x_1 + b y_1)^2 + \frac{m}{2q} y_1^2 \\
& = 2(qx_1^2 + b x_1 y_1 + h y_1^2).
\end{align*}
$$

$v = qx_1^2 + bx_1 y_1 + hy_1^2$는 양의 정수이다. 이때, $0 < R_1^2 + 2v < 2m$이고, $m \mid R_1^2 + 2v$이었으므로 $R_1^2 + 2v = m$이다.

$2v$는 제곱수 두 개의 합으로 나타남을 보일 것이다. $v$를 정확히 홀수 번 나누는 홀수 소수를 $p$라고 하자. $p$가 $m$을 나누지 않으면, $R_1^2 \equiv m \pmod{p}$이므로 $(m/p) = 1$이다. $4qv = (2qx_1 + by_1)^2 + my_1^2$이다. $p \mid q$이면, 이 등식으로부터 $(-m/p) = 1$이다. $p \nmid q$이면, 어떤 정수 $e, f$에 대해 $e^2 + mf^2$는 $p$로 홀수 번 나누어진다. $e, f$를 적당히 $p$로 나누어서 법 $p$에 대해 0이 아닌 정수를 얻을 수 있고, 이는 $(-m/p) = 1$을 의미한다. 두 경우 모두 $(-m/p) = 1$이다. $(m/p) = 1$과 $(-m/p) = 1$애 의해 $(-1/p) = 1$이고, 따라서 $p \equiv 1 \pmod{4}$.

$p$가 $m$을 나눈다고 가정하자. $R_1^2 + 2v = R_1^2 + \frac{1}{2q} ((2qx_1 + by_1)^2 + my_2^2)  = m$이므로, $p$는 $R_1$, $2qx_1 + by_1$을 나눈다. $m$은 제곱 인수를 갖지 않으므로, 양변을 $p$로 나누면 $\frac{1}{2q} \frac{m}{p} y_1^2 \equiv \frac{m}{p} \pmod{p} $이다. 따라서 $y_1^2 \equiv 2q \pmod{p}, (2q/p) = 1$이다. 가장 위에서 다루었던 조건인 $(-2q/p) = 1$을 사용하면, $(-1/p) = 1$이고 따라서 $p \equiv 1 \pmod{4}$.

$v$를 홀수 번 나누는 홀수 소수는 모두 법 4에 대해 1과 합동이므로, $2v$는 제곱수 두 개의 합으로 나타내어진다. 르장드르 세 제곱수 정리가 $m \equiv 3 \pmod{8}$인 양의 정수에 대해 증명되었다.

# 다른 나머지를 가질 때

$m \equiv 1, 2, 5, 6 \pmod{8}$일 때에도, 위의 증명과 크게 다르지 않은 방법으로 증명할 수 있다. $m$을 나누는 모든 홀수 소수 $p$에 대해 $(-q/p) = 1$이고, $q \equiv 1 \pmod{4}$인 소수 $q$를 잡는다. $m$이 짝수일 경우, $m = 2m_1$이라고 할 때, $(-2/q) = (-1)^{(m_1 - 1)/2}$를 추가로 만족시키도록 $q$를 잡자. $t^2 = -1/q \pmod{p}$인 홀수 $t$를 잡고, $b^2 - qh = -m$을 만족하는 $b$를 잡는다. 그리고 좌표변환 
$$
\begin{align*}
R & = tqx + tby + mz \\
S & = q^{1/2}x + \frac{b}{q^{1/2}} y \\
T & = \frac{m^{1/2}}{q^{1/2}} y
\end{align*}
$$
를 이용하면, 같은 방법으로 르장드르 세 제곱수 정리를 증명할 수 있다. 따라서 모든 제곱인수가 없는 양의 정수가 $8n + 7$ 꼴이 아니라면 제곱수 세 개의 합으로 나타낼 수 있다.

# 참고 문헌
[1] N. C. Ankeny. *Sums of three squares*. 1957.
